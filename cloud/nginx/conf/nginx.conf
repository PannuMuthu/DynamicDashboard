http{
  server {
    # Listen for incoming connections on port 80
    listen 80 default_server;
    listen [::]:80 default_server;

    # Change grafana.example.com to your Grafana endpoint URL
    server_name dev2.virnao.com;
    # Return all HTTP requests to URL to HTTPS
    return 301 https://dev2.virnao.com$request_uri;
  }

  server {
    # Listen form incoming connections on port 443 via HTTPS
    listen 443 ssl http2;
    listen [::]:443 ssl http2;

    # SSL certificate and private key
    ssl_certificate     /etc/grafana/fullchain.pem;
    ssl_certificate_key /etc/grafana/privkey.pem;
    # Change grafana.example.com to your Grafana endpoint URL
    server_name dev2.virnao.com;
    
    location ~ /.well-known/acme-challenge/ {
      # Location to store certbot configurations
      root /var/www/certbot;
    }

    location / {
      # Assign incoming requests from port 80 to this URL
      proxy_pass https://dev2.virnao.com:3000/;
      proxy_set_header Host $http_host;
      proxy_set_header X-Real-IP $remote_addr;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto “https”;
    }
  }

  server {
    listen 8080 ssl;
    server_name dev2.virnao.com;
    ssl_certificate     "/etc/grafana/fullchain.pem";
    ssl_certificate_key "/etc/grafana/privkey.pem";
        
    location / {
      proxy_set_header Host $http_host;
      proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header X-Forwarded-Proto $scheme;
      proxy_set_header Upgrade $http_upgrade;
      proxy_set_header Connection "Upgrade";
      proxy_pass https://dev2.virnao.com:3000;
    }
  }
}

;   server {
;     listen 3000 ssl;
;     listen [::]:3000 ssl;
;     server_name dev2.virnao.com;
;     ssl_certificate     "/etc/grafana/fullchain.pem";
;     ssl_certificate_key "/etc/grafana/privkey.pem";
        
;     location / {
;       proxy_set_header Host $http_host;
;       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
;       proxy_set_header X-Forwarded-Proto $scheme;
;       proxy_set_header Upgrade $http_upgrade;
;       proxy_set_header Connection "Upgrade";
;       proxy_pass https://dev2.virnao.com:3000;
;     }
;   }

; server {
;     listen 8543 ssl;

;     server_name dev1.virnao.com;
;     ssl_certificate "/etc/ssl/private/tls.crt";
;     ssl_certificate_key "/etc/ssl/private/tls.key";

;     location /auth/realms/StackV {
;       proxy_set_header Host $http_host;
;       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
;       proxy_set_header X-Forwarded-Proto $scheme;
;       proxy_set_header Upgrade $http_upgrade;
;       proxy_set_header Connection "Upgrade";
;       proxy_pass https://keycloak:8443;
;     }
;     location /auth/admin/realms/StackV {
;       proxy_set_header Host $http_host;
;       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
;       proxy_set_header X-Forwarded-Proto $scheme;
;       proxy_set_header Upgrade $http_upgrade;
;       proxy_set_header Connection "Upgrade";
;       proxy_pass https://keycloak:8443;
;     }
;     location /auth/resources {
;       proxy_set_header Host $http_host;
;       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
;       proxy_set_header X-Forwarded-Proto $scheme;
;       proxy_set_header Upgrade $http_upgrade;
;       proxy_set_header Connection "Upgrade";
;       proxy_pass https://keycloak:8443;
;     }
; }
; server {
;     listen 8201 ssl;
;       server_name dev2.virnao.com;
;       ssl_certificate "/etc/ssl/private/tls.crt";
;       ssl_certificate_key "/etc/ssl/private/tls.key";

;     location / {
;       proxy_set_header Host $http_host;
;       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
;       proxy_set_header X-Forwarded-Proto $scheme;
;       proxy_set_header Upgrade $http_upgrade;
;       proxy_set_header Connection "Upgrade";
;       proxy_pass https://dev2.virnao.com:3000;
;     }
; }

;   server {
;     listen 3000 ssl;
;     server_name dev2.virnao.com;
;     ssl_certificate     "/etc/grafana/fullchain.pem";
;     ssl_certificate_key "/etc/grafana/privkey.pem";
        
;     location / {
;       proxy_set_header Host $http_host;
;       proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
;       proxy_set_header X-Forwarded-Proto $scheme;
;       proxy_set_header Upgrade $http_upgrade;
;       proxy_set_header Connection "Upgrade";
;       proxy_pass https://dev2.virnao.com:3000;
;     }
;   }